# 核心概念（ES是面向文档的，索引、类型、文档、字段一切都是JSON）
- ES（集群）中可以包含多个索引（索引对应数据库）
- 每个索引中可以包含多个类型（类型对应数据库中的表，但是在ES7版本中类型已经在慢慢被弃用，ES8中没有类型了）
- 每个类型下又包含多个文档（文档对应数据表中的一行数据）
- 每个文档中又包含多个字段（字段对应数据表中的列信息）

# 物理设计
ES在后台把每个索引划分成多个分片，每个分片可以在集群中的不同服务器间迁移，一个节点也是一个集群，默认的集群名称就是elasticsearch

### 节点和分片如何工作？
一个集群至少有一个节点，而一个节点就是一个 elasricsearch 进程，节点可以有多个索引默认的，如果你创建索引，那么索引默认将会有个5个分片 ( primary shard ,又称主分片 ) 构成的，每一个主分片会有一个副本 ( replica shard ,又称复制分片 )
主分片和对应的复制分片都不会在同一个节点内，这样有利于某个节点挂掉了，数据也不至于丢失
实际上，一个分片是一个 Lucene 索引，一个包含倒排索引的文件目录，倒排索引的结构使得elasticsearch在不扫描全部文档的情况下，就能告诉你哪些文档包含特定的关键字

在 elasticsearch 中， 索引这个词被频繁使用，这就是术语的使用。在 elasticsearch 中，索引被分为多个分片，每份分片是一个 Lucene 的索引。所以 一个 elasticsearch 索引是由多个Lucene索引组成的。别问为什么，谁让elasticsearch使用Lucene作为底层呢! 如无特指，说起索引都是指elasticsearch的索引

### 倒排索引
elasticsearch 使用的是一种称为倒排索引的结构，采用Lucene倒排索引作为底层。这种结构适用于快速的全文搜索， 一个索引由文档中所有不重复的列表构成，对于每一个词，都有一个包含它的文档列表。 例如，现在有两个文档， 每个文档包含如下内容：
~~~
Study every day, good good up to forever # 文档1包含的内容
To forever, study every day, good good up # 文档2包含的内容
~~~

为了创建倒排索引，我们首先要将每个文档拆分成独立的词(或称为词条或者tokens)，然后创建一个包含所有不重复的词条的排序列表，然后列出每个词条出现在哪个文档 :
~~~
词语          doc_1      doc_2
Study         存在       不存在
To           不存在       存在
every         存在        存在       
forever       存在        存在
day           存在        存在  
study        不存在       存在     
good          存在        存在  
up            存在        存在 
to            存在       不存在 
~~~

现在试图搜索 to forever，只需要查看包含每个词条的文档
~~~
词语          doc_1      doc_2
to            存在       不存在
forever       存在        存在
匹配数量       2            1
~~~
两个文档都匹配，但是第一个文档比第二个匹配程度更高。如果没有别的条件，现在，这两个包含关键字的文档都将返回


再来看一个示例，比如通过博客标签来搜索博客文章。那么倒排索引列表就是这样的一个结构
博客文章(原始数据)   
~~~
博客文章ID         标签 
1                 python
2                 python
3                 linux,python
4                 linux
~~~

索引列表(倒排索引) 
~~~
标签             博客文章ID
python           1，2，3
1inux            3，4
~~~
如果要搜索含有 python 标签的文章，那相对于查找所有原始数据而言，查找倒排索引后的数据将会快的多。只需要 查看标签这一栏，然后获取相关的文章ID即可。完全过滤掉无关的所有数据，提高效率

