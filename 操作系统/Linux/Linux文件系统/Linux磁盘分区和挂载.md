
### 每块磁盘都分为主分区和扩展分区，主分区和扩展分区加起来最多只能有4个并且扩展分区最多只能有1个
- 主分区主要是用来启动操作系统的，它主要放的是操作系统的启动或引导程序，/boot分区最好放在主分区上；
- 扩展分区不能存储数据和格式化，而是做为逻辑分区的容器存在，必须在分成逻辑分区才能使用
- 真正存放数据的是主分区和逻辑分区，大量数据都放在逻辑分区中。
 
### 磁盘在dev的目录下，磁盘目录名称由3部分组成：
- 第一部分是磁盘的类型，有如下类型
  - hd：IDE 磁盘
  - sd：SCSI 磁盘，一般是这种磁盘
  - vd：virtio 磁盘，这是可热插拔的磁盘，一般是在云服务器上可以见到
- 第二部分是一个字母，表示机器的第几块磁盘，例如a表示第一块磁盘，b表示第二块磁盘等
- 第三部分是一个数字，1到4表示的主分区或扩展分区，大于4的数字是逻辑分区。注意即使主分区和扩展分区加起来没有4个，逻辑分区的数字也是从5开始，
- 所以磁盘的目录应该是例如 /dev/sda1 、 /dev/sda2 这样子的

~~~shell
# 使用fdisk进行分区
fdisk [硬盘文件名]
# 注意是硬盘文件名，例如/dev/sda 、/dev/sdb 等，后面不要添加分区号
# 执行命令进入交互界面，输入交互命令可以进行操作，按m可以查看帮助信息
# 以下是不同的交互命令，如果按错了交互命令直接按退格键是无法删除，需要按Ctrl+退格键删除
a	设置可引导标记
b	编辑 bsd 磁盘标签
c	设置 DOS 操作系统兼容标记
d	删除一个分区
l	显示已知的文件系统类型。82 为 Linux swap 分区，83 为 Linux 分区
m	显示帮助菜单
n	新建分区。按n出现选择。选择1：按p回车分主分区，再输入分区号回车，它会让你选择从那个柱面开始直接回车默认即可，然后会让你选择到那个柱面结束，注意这个时候不要直接输入数字，而是输入 +size[G/M/K]回车主分区完成。如果磁盘没有扩展分区会出现选择2：可以按e分扩展分区，再输入分区号回车，它会让你选择从那个柱面开始直接回车默认即可，然后会让你选择到那个柱面结束，注意这个时候不要直接输入数字，而是输入 +size[G/M/K]回车分区完成。如果磁盘有扩展分区会出现选择3：可以按l分逻辑分区，它会让你选择从那个柱面开始直接回车默认即可，然后会让你选择到那个柱面结束，注意这个时候不要直接输入数字，而是输入 +size[G/M/K]回车分区完成。注意分区完成后必须按w进行保存退出才算真正的完成分区
o	建立空白 DOS 分区表
P	显示分区列表
q	不保存退出
s	新建空白 SUN 磁盘标签
t	改变一个分区的系统 ID
u	改变显示记录单位
V	验证分区表
w	保存退出
X	附加功能（仅专家）


# 逻辑分区之间的磁盘划分，即一个分区的磁盘空间拿出一部分给另一磁盘
# 参考https://blog.csdn.net/weixin_38924500/article/details/106664613
# 参考https://my.oschina.net/jasonMrliu/blog/1604954

# 重新读取分区表信息，用途是注意分区后可能会出现分区表占用需要重启系统，可以使用以下命令重新读取分区表信息不必重启系统
partprobe

# 格式化，用于在新的分区上建立 linux 文件系统，文件系统建立后使用mount挂载后就可以正常使用了，也可用于文件不重要时修复文件系统
mkfs -t [文件系统类型] [硬盘文件名或磁盘分区目录]
# -t参数简写为点连接文件系统类型
mkfs.[文件系统类型] [硬盘文件名或磁盘分区目录]

# 外部设备目录挂载，比如光盘文件、u盘文件等在windows在插入电脑后会自动挂载并分配盘符，而linux需要手动挂载分配挂载点目录
mount [参数] [设备目录] [挂载目录]
# 不加任何参数以及设备目录和挂载目录表示查看已经挂载的设备，例如显示的 /dev/sda1 on / type ext4 (rw) 表示磁盘sda1分区挂载到/目录，文件系统的类型是ext4，可以读写
# -t参数指定文件系统类型，例如ext3、ext4、iso9660（光盘的文件系统）等，一般目前的硬盘都是ext4。如果不清楚设备的文件系统可以使用 file -s [设备目录]  查看设备文件系统类型
# -a参数依据配置文件/etc/fstab的内容进行自动挂载，需要提前修改配置文件，并且挂载时注意一定要在/dev/目录下有对应的设备文件（u盘就是表示机器插上u盘，其他设备也是一样），否则系统会开机就崩溃
# -o参数表示额外的挂载选项，一般不使用直接默认，多个额外的挂载选项使用逗号分隔，有如下额外的挂载选项
# 额外的挂载选项：atime和noatime分别表示更新访问时间和不更新访问时间，即挂载点下的文件时是否更新文件的访问时间，默认是更新
# 额外的挂载选项：async和sync分别表示异步和同步，默认挂载点下的文件是异步
# 额外的挂载选项：auto和noauto分别表示自动和手动，即mount -a 进行挂载时是否依据配置文件/etc/fstab的内容进行自动挂载，默认是
# 额外的挂载选项：defaults表示使用默认值，相当于rw,suid,dev,exec,auto,nouser,async这7个额外的挂载选项
# 额外的挂载选项：exec和noexec表示执行和不执行，即挂载点下的文件是否可以执行，默认是执行，如果是不执行那么root用户也执行不了挂载点下的文件
# 额外的挂载选项：remount表示重新挂载已经挂载的文件系统，一般是用来修改特殊权限
# 额外的挂载选项：rw和ro表示挂载点下文件的权限读写和只读，默认是rw读写
# 额外的挂载选项：suid和nosuid表示挂载点下文件目录是否可以设置SUID权限和SGID权限，默认是可以
# 额外的挂载选项：user和nouser表示允许普通用户挂载和不允许普通用户挂载，默认普通用户不允许挂载只有root用户可以挂载
# 额外的挂载选项：usrquota表示写入代表文件系统支持用户磁盘配额，默认不支持
# 额外的挂载选项：grpquota表示写入代表文件系统支持用户磁盘配额，默认不支持

# 挂载U盘一般是在/mnt下创建一个新的目录挂载，挂载光盘一般是在/media下创建一个新的目录挂载
# 注意光盘的挂载都会报挂载写失败，原因是光盘是只读的
# 事实上设备目录是原目录、而挂载目录是原目录的软链接

# 解除目录挂载，注意要在挂载目录之外执行才能成功
umount [设备目录或挂载目录之一]

# 每次重启系统之前外部设备目录的手动挂载都会失效，而依据配置文件/etc/fstab的内容编辑可以进行系统开机自动挂载
# 注意的是外部设备一定要与主机是连接的，否则系统会开机就崩溃
# /etc/fstab配置文件一定要谨慎编辑，如果写错并且关机重启会系统崩溃
# /etc/fstab配置文件的内容有六列
# 第一列是分区设备文件名或者是UUID（UUID是硬盘的唯一识别码，通过dumpe2fs可以看到，推荐使用UUID，设备文件名互相修改名称会出现问题）
# 第二列是挂载点
# 第三列是文件系统
# 第四列是mount 的-o参数表示额外的挂载选项，一般是defaults
# 第五列是指定分区是否被dump备份，0表示不备份，1表示每天备份，2表示不定期备份，备份数据在挂载点目录下的lost+found目录中
# 第六列是指定分区是否被fask检测，0表示不检测，其他数字表示检测的优先级，数字越小则优先级约高，一般只有/分区是1，其他最高都是2
# 添加一个新的分区进行自动挂载就添加一行，例如 /dev/sdb1    /disk1    ext4  defaults  1  2
# 请注意在编辑完/etc/fstab配置文件一定不要关机，而是先执行mount -a先根据/etc/fstab配置文件进行自动挂载验证一下，如果没有提示就是配置文件没有写错，如果有提示请按照提示重新编辑/etc/fstab配置文件然后在执行mount -a验证直到没有提示错误
# 例如上述添加一个新的分区进行自动挂载就添加一行时，写入的是 /dev/sdb    /disk1    ext4  defaults  1  2 分区设备文件名写错了，并且没有使用mount -a验证而是直接关机重启了，这时系统启动直接报错告诉你无法正常挂载，但是会要求你输入root用户的密码，输入root用户的密码后会进入Shell终端，然后修改/etc/fstab配置文件，但是/etc/fstab配置文件这个时候是只读文件不允许修改，root也无法强制修改，这是由于/分区在挂载时被挂载成了ro只读，所以需要先执行mount -o remount,rw / 重新挂载/分区为rw读写，才能修改/etc/fstab配置文件，将写错的配置修改正确然后保存退出，mount -a验证没有问题，重启系统就解决了。但是注意这种修复仅限于除了/分区之外的其它分区配置写错，要是/分区的配置写错那么系统启动都不会报错而是直接崩溃

#swap 分区通常被称为交换分区，这是一块特殊的硬盘空间，即当实际内存不够用的时候，操作系统会从内存中取出一部分暂时不用的数据，放在交换分区中，从而为当前运行的程序腾出足够的内存空间。也就是说，当内存不够用时，我们使用 swap 分区来临时顶替。使用 swap 交换分区，显著的优点是，通过操作系统的调度，应用程序实际可以使用的内存空间将远远超过系统的物理内存。由于硬盘空间的价格远比 RAM 要低，因此这种方式无疑是经济实惠的。当然，频繁地读写硬盘，会显著降低操作系统的运行速率，这也是使用 swap 交换分区最大的限制。具体使用多大的 swap 分区，取决于物理内存大小和硬盘的容量。一般来讲，swap 分区容量应大于物理内存大小，建议是内存的两倍

# 查看swap分区和内存使用情况
free [参数]
# 默认不加参数以Kb为单位，一个有6列分别是总容量、已经使用容量、剩余空闲容量、共享的容量、缓冲区大小、缓存大小。缓冲区的作用是加快写入操作，即写入数据的时候先将分散的写入操作保存到内存中，当达到一定程度再集中的写入磁盘中，减少的磁盘碎片与磁盘的反复寻道，加速了数据的写入过程。缓存的作用是加快读取操作，把从磁盘中的数据读取保存到内存当中，当再次读取数据时，不用读取硬盘而是直接从内存中读取，加速了数据的读取过程
# -h参数表示人性化的单位显示容量
# -g参数表示以GB作为单位显示容量
# -m参数表示以MB作为单位显示容量

# 增加swap分区容量
# 第一步先创建一个swap逻辑分区：fdisk [硬盘文件名] 按n回车新建分区，（注意要先有扩展分区才能在扩展分区下创建逻辑分区）按l分逻辑分区，它会让你选择从那个柱面开始直接回车默认即可，然后会让你选择到那个柱面结束，注意这个时候不要直接输入数字，而是输入 +size[G/M/K]回车分区完成。但是这是一个标准分区分区的ID号是83，修改分区的ID号输入t回车，它会让你选择修改那个分区的ID号输入新建的分区号（例如/dev/sda6就是6，/dev/vda7就是7），然后会让你输入新的分区ID号直接输入代表swap分区的ID号82回车，按p会显示分区列表，检查一下新的分区信息是否正常，注意分区完成后必须按w进行保存退出才算真正的完成分区，执行partprobe重新读取分区表信息或重启系统
# 第二步格式化swap分区（注意不是格式化标准分区的命令mkfs）: mkswap [分区设备文件名] 如果显示找不到分区设备文件名目录请检查一下上一步的swap逻辑分区是否创建，如果创建了就是读取分区表信息没有生效还是得重启系统
# 第三步将新建好的swap分区挂载加入系统的swap分区：swapon [分区设备文件名]  同样从系统swap分区取消部分swap分区设备使用swapoff [分区设备文件名]
# 第四步使用free -h 查看系统swap分区的总容量相比原来已经增加了第一步创建的逻辑分区容量大小
# 注意使用第三步的命令手动将新建好的swap分区挂载加入系统的swap分区，在系统重启后会失效，同样可以修改/etc/fstab配置文件实现系统开机自动挂载(谨慎修改/etc/fstab配置文件)，例如在配置文件中加入一行  /dev/sdb6    swap   swap   defaults  0  0  其中第二个字段挂载是swap不是/swap不用写错了，文件系统类型也是swap
~~~
---
 