## Kali Linux是基于Debian的Linux发行版，设计用于数字鉴识和渗透测试。由Offensive Security公司维护和资助。

## Kali Linux内置了大约600个渗透测试程序（工具），包括Armitage（图形化网络攻击管理工具）、Nmap（端口扫描工具）、Wireshark（数据包分析器）、Metasploit（渗透测试框架）、John the Ripper（密码破解器）、sqlmap（自动SQL注入和数据库接管工具）、Aircrack-ng（用于渗透测试无线局域网的软件包）、Burp suite以及OWASP ZAP网络应用安全扫描器等。

### kali Linux系统安装参考：https://blog.csdn.net/fingue/article/details/127559353
~~~shell
# 注意 kail linux 默认是没有启动ssh远程登录服务的，需要手动开启和设置开机启动
sudo systemctl start ssh
sudo systemctl enable ssh
~~~

# 准备入侵

## 第一步：渗透测试收集信息
### 收集那些信息
- 收集简要的情报信息
  - 定位目标系统的IP地址范围
  - 详细的注册信息
  - DNS服务器的位置
  - 电话号段
  - 网络、安全管理员的联系方式
  - 外部网络拓扑结果
- 进一步挖掘情报信息
  - 目标网络中活跃的主机
  - 操作系统类型
  - 开放的端口号，以及端口运行的具体服务
  - 是否存在公开披露出来的漏洞
- 收集系统内部信息
  - 用户账号
  - 共享资源
  - 网络服务类型和版本号
  - 服务配置信息

### 收集信息使用的工具和方法
- 踩点 footprinting
  - web搜索和挖掘
  - DNS和IP查询
  - 网络拓扑侦察
- 扫描 scanning
  - 主机扫描
  - 端口扫描
  - 系统类型探查
  - 漏洞扫描
- 查点 enumberating
  - Flag抓取
  - 网络服务查点

### 信息挖掘实施工作
~~~shell
# 浏览器搜索 site:域名 搜索信息，确定域名真时存在并且提供服务

# dnsenum 收集域名使用的IP地址、DNS地址信息
# nslookup 收集域名使用的IP地址，会将域名对应的多个IP都列出来
dnsenum --enum baidu.com
nslookup baidu.com

# whois 查询域名是否以及注册，以及域名的注册人、注册商等信息
whois baidu.com

# traceroute 查询发送到指定域名的数据包中间经过的线路信息，但是目前大部分的线路节点都做了屏蔽，是无法查看到信息的
traceroute baidu.com

# 判断目标主机是否存活以及查看ip地址
ping baidu.com

# nmap 端口扫描，参考：https://blog.csdn.net/Xxy605/article/details/107620999
nmap [-Pn] [服务器IP或域名或网段] [-p 80,443 或 1-40000] [-sV]
# -sS 参数: 执行TCP SYN扫描，这是Nmap默认的扫描方式，通常被称为半开放扫描。
# -sT 参数：使用 tcp 扫描
# -sU 参数：使用 udp 扫描
# -sP 参数：使用 ICMP 扫描，即ping
# -p 参数指定扫描端口或者是端口扫描范围
# -sV 参数探测主机的开放端口以确定该端口的服务和版本信息
# -O 参数尝试识别目标主机的操作系统，需要root权限才能启用
# -A 参数: 启用操作系统检测、版本检测、脚本扫描和跟踪路由，需要root权限才能启用
# -Pn 参数: 一些情况下目标主机会欺骗显示关闭但是实际是开启的，跳过主机发现，直接进行主机的端口扫描
# -sN 参数：TCP空扫描欺骗防火墙
# --traceroute 参数：进行路由跟踪
# -v参数: 提高输出信息的详细程度（可以使用多个v来增加详细程度）

# 指纹信息收集，p0f是被动的指纹收集工具，用于收集链接当前机器的设备操作系统，即使是在系统上装有性能良好的防火墙的情况下也没有问题
sudo p0f [参数]
# 网络接口参数:
#   -i iface  - 指定监听的网络接口
#   -r file   - 读取由抓包工具抓到的网络数据包文件，即 .pcap 文件
#   -p        - 设置 -i参数 指定的网卡 为混杂模式
#   -L        - 列出所有可用接口
# 操作模式和输出设置参数:
#   -f file   - 指定指纹数据库 (p0f.fp) 路径，不指定则使用默认数据库。(默认：/etc/p0f/p0f.fp)
#   -o file   - 将信息写入指定的日志文件中。只有同一网卡的log文件才可以附加合并到本次监听中来。
#   -s name   - 回答 unix socket 的查询 API
#   -u user   - 以指定用户身份运行程序，工作目录会切换到到当前用户根目录下；
#   -d        - 以后台进程方式运行p0f (requires -o or -s)
# 性能相关的选项参数:
#   -S limit  - 设置API并发数，默认为20，上限为100；
#   -t c,h    - 设置连接超时时间 (30s,120m)
#   -m c,h    - 设置最大网络连接数(connect)和同时追踪的主机数(host)(默认值: c = 1,000, h = 10,000).

~~~

### 暴力hash碰撞解密
~~~shell
# 查看哈希值是通过什么算法加密的，一般哈希值是这样的 $id$salt$encrypted
man crypt
# 一般id号代表加密方式，常见的如下
#   1   | MD5
#   2a  | Blowfish (not in mainline glibc; added in some Linux distributions)
#   5   | SHA-256 (since glibc 2.7)
#   6   | SHA-512 (since glibc 2.7)

# 搜索查看加密方式类型的编号：Hash types 列表下对应加密算法的编号
man hashcat 

# 暴露字典破解，只要猜测字典数量够多就能破解
hashcat -m [加密算法编号] --force [存放hash值的文件] [字典文件，每行都是可能的密码]
# --show 参数：只查看破解的密码信息
# kali系统中提供的字典 /usr/share/wordlists/rockyou.txt.gz 该字典很大并且猜测的常见密码都在其中，可以使用这个字典进行暴力破解
# 例如  hashcat -m 1800 --force test.hash test.txt 其中的1800就是SHA-512 加密，即哈希值中开头$后面的id是6
~~~








